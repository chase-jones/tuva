version: 2
models:
- name: readmissions__encounter_augmented
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_readmissions
      {% else %}readmissions{%- endif -%}
    alias: encounter_augmented
    tags: readmissions
    materialized: table
  description: "This model includes all encounters from the stg_encounter model, and
    for each encounter_id we add fields relevant for the encounter."
  columns:
  - name: test
    description: test  - name: encounter_id
    description: "The unique identifier for the encounter"
  - name: patient_id
    description: "The unique identifier for the patient"
  - name: admit_date
    description: "The date of admission for the inpatient visit"
  - name: discharge_date
    description: "The date of discharge for the inpatient visit"
  - name: discharge_disposition_code
    description: "The valid 2-digit discharge status for the inpatient visit"
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
  - name: facility_id
    description: ''
  - name: ms_drg_code
    description: "The MS-DRG associted with the inpatient visit"
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
  - name: paid_amount
    description: "The number of dollars paid on the encounter"
  - name: length_of_stay
    description: "Integer representing the length of stay of the inpatient visit in
      days"
    data_type: integer
  - name: index_admission_flag
    description: "Flag to indicate if the encounter is an index admission"
    data_type: boolean
  - name: planned_flag
    description: "Flag to indicate if the encounter was planned"
    data_type: boolean
  - name: specialty_cohort
    description: "Specialty cohort the encounter belongs to"
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/value_sets/readmissions/readmissions__specialty_cohort.csv
  - name: died_flag
    description: "Flag to indicate of the patient died in this encounter"
    data_type: boolean
  - name: diagnosis_ccs
    description: "CCS code associated with the primary diagnosis for the encounter"
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/value_sets/readmissions/readmissions__acute_diagnosis_ccs.csv
  - name: disqualified_encounter_flag
    description: "A flag that indicates whether this encounter is disqualified from
      being used in readmission measures for any critical data quality problem."
    data_type: boolean
  - name: missing_admit_date_flag
    description: "A flag that indicates whether the admit date is missing from this
      encounter."
    data_type: boolean
  - name: missing_discharge_date_flag
    description: "A flag that indicates whether the discharge date is missing from
      this encounter."
    data_type: boolean
  - name: admit_after_discharge_flag
    description: "A flag that indicates whether the admit date for the encounter is
      after the discharge date for the encounter."
    data_type: boolean
  - name: missing_discharge_disposition_code_flag
    description: "A flag that indicates whether the discharge status code is missing
      for the encounter."
    data_type: boolean
  - name: invalid_discharge_disposition_code_flag
    description: "A flag that indicates whether the discharge status code that is
      present for this encounter is invalid. This flag is 1 only when the discharge
      status code is present but invalid."
    data_type: boolean
  - name: missing_primary_diagnosis_flag
    description: "A flag that indicates whether there is no primary diagnosis associated
      with the encounter."
    data_type: boolean
  - name: invalid_primary_diagnosis_code_flag
    description: "A flag that indicates whether the primary diagnosis present for
      this encounter is invalid, i.e. a non existing ICD-10-CM code. This flag indicates
      that a primary diagnosis code is indeed present for the encounter, but it is
      not a valid ICD-10-CM code."
    data_type: boolean
  - name: no_diagnosis_ccs_flag
    description: "A flag that indicates whether there is no CCS diagnosis category
      associated with the primary ICD-10-CM diagnosis code for the encounter. This
      flag indicates that there is a valid primary ICD-10-CM diagnosis code associated
      with the encounter, but there is no CCS diagnosis category associated with that
      ICD-10-CM code."
    data_type: boolean
  - name: overlaps_with_another_encounter_flag
    description: "A flag that indicates whether this encounter's dates overlap with
      those of another encounter in the dataset"
    data_type: boolean
  - name: missing_ms_drg_flag
    description: "A flag that indicates whether this encounter contains a claim with
      a missing ms-drg code"
    data_type: boolean
  - name: invalid_ms_drg_flag
    description: "A flag that indicates whether this encounter contains a claim with
      an invalid missing ms-drg code"
    data_type: boolean
  - name: tuva_last_run
    description: The time at with the model was materialized. Generated by `dbt_utils.pretty_time`
      as the local time of the `dbt run` environment.  Timezone is configurable via
      the `tuva_last_run` var.


