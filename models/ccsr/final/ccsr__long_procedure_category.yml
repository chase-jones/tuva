version: 2
models:
- name: ccsr__long_procedure_category
  description: >
    This model contains a mapping of individual condition ICD-10-PCS procedure  codes
    to the CCSR's clinically meaningful procedure categories. Each row  represents
    a mapping of an ICD-10 code to a CCSR category. The model is  equivalent to the
    CCSR's Output Option 1 - Vertical File Output.
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_ccsr
      {% else %}ccsr{%- endif -%}
    alias: long_procedure_category
    tags:
    - ccsr
    materialized: table
  columns:
  - name: test
    description: test
  - name: encounter_id
    description: >
      The encounter_id for the encounter where this procedure was performed.
  - name: claim_id
    description: Unique identifier for each claim.
  - name: patient_id
    description: Unique identifier for each patient.
  - name: normalized_code
    description: The ICD-10-PCS code for the procedure.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__icd_10_pcs.csv
      terminology_note: "**Note: this terminology set is too large to be loaded as
        a seed and is instead loaded from public cloud storage for supported adapters."
  - name: code_description
    description: >
      The ICD-10-PCS code description provided in the CCSR CSV seed file.
  - name: ccsr_parent_category
    description: >
      The parent category code for each CCSR category. In practice, this is  the three
      letter prefix to the category code.
  - name: ccsr_category
    description: The CCSR category mapped to the ICD-10-PCS code.
  - name: ccsr_category_description
    description: A description of the clinical domain.
  - name: clinical_domain
    description: >
      The ICD-10-PCS Clinical Domain that the CCSR parent category belongs  to. Note
      that the condition models don't have this column, but the  `body_system` is
      a conceptually related column in the condition tables.
  - name: prccsr_version
    description: >
      The version number of the CCSR program from which the dbt model was  derived.
  - name: tuva_last_run
    description: >
      The time at with the model was materialized. Generated by  `dbt_utils.pretty_time`
      as the local time of the `dbt run` environment.   Timezone is configurable via
      the `tuva_last_run` var.

### Intermediate

