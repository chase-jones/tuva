version: 2
models:
- name: ccsr__procedure_category_map
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_ccsr
      {% else %}ccsr{%- endif -%}
    alias: procedure_category_map
    tags:
    - ccsr
    materialized: table
  description: >
    This is an intermediate model that renames some PRCCSR columns to align  with
    other TUVA models as well as the `ccsr__dx_vertical_pivot` model.
  columns:
  - name: code
    description: The ICD-10-PCS code
  - name: code_description
    description: >
      The description of the ICD-10-PCS code included in the seed file.
  - name: ccsr_category
    description: The CCSR category to which the ICD-10 code is mapped.
  - name: ccsr_parent_category
    description: >
      The CCSR parent category - the three letter prefix for each  alphanumeric category.
  - name: ccsr_category_description
    description: A description of the CCSR category.
  - name: clinical_domain
    description: >
      The clinical domain to which the CCSR code belongs. Note that the  condition
      models don't have this column, but the `body_system` is a  conceptually related
      column in the condition tables.
  - name: tuva_last_run
    description: >
      The time at with the model was materialized. Generated by  `dbt_utils.pretty_time`
      as the local time of the `dbt run` environment.   Timezone is configurable via
      the `tuva_last_run` var.

## Staging

