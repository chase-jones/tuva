version: 2
models:
- name: cms_hcc__patient_risk_scores
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_cms_hcc{% else %}cms_hcc{%- endif -%}
    alias: patient_risk_scores
    tags: cms_hcc
    materialized: table
  description: >
    This final model calculates the CMS HCC raw risk score, blended risk score,
    normalized risk score, and payment risk score for each enrollee in the  payment
    year.
  columns:
  - name: patient_id
    description: Unique ID for the patient.
    tests:
    - unique
  - name: v24_risk_score
    description: >
      The sum of all patient risk factors from model version CMS-HCC-V24.  If payment
      year >= 2024 then the score may be weighted following  CMS's transition plan.
  - name: v28_risk_score
    description: >
      The sum of all patient risk factors from model version CMS-HCC-V28.
      If payment year >= 2024 then the score may be weighted following  CMS's transition
      plan.
  - name: blended_risk_score
    description: The of sum v24_risk_score and v28_risk_score.
  - name: normalized_risk_score
    description: >
      The blended risk score divided by the normalization adjustment factor  for the
      corresponding HCC model version and payment year's rate  announcement from CMS.
  - name: payment_risk_score
    description: >
      The normalized risk score multiplied by the MA coding pattern  adjustment factor
      for the corresponding HCC model version  and payment year's rate announcement
      from CMS.
  - name: payment_year
    description: >
      The payment year the HCC and risk scores are being calculated for.
  - name: tuva_last_run
    description: The date the model was run.

## Intermediate
