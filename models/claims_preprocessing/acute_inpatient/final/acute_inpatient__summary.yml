version: 2
models:
- name: acute_inpatient__summary
  description: This table pulls together all the data needed to perform acute inpatient
    analytics into a single table.
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
      {% else %}claims_preprocessing{%- endif -%}
    alias: acute_inpatient_summary
    tags:
    - acute_inpatient
    - claims_preprocessing
    materialized: table
  columns:
  - name: encounter_id
    description: Unique identifier for the acute inpatient encounter.
  - name: encounter_start_date
    description: Date when the patient was admitted.
  - name: encounter_end_date
    description: Date when the patient was discharged.
  - name: patient_id
    description: Unique identifier for each patient in the dataset.
  - name: admit_age
    description: The age of the patient as of their admission date.
  - name: gender
    description: The gender of the patient.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
  - name: race
    description: The race of the patient.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
  - name: facility_npi
    description: The NPI for the facility where the encounter occurred.
  - name: provider_first_name
    description: The first name of the provider.
  - name: provider_last_name
    description: The last name of the provider.
  - name: ms_drg_code
    description: The MS-DRG code associted with the inpatient visit
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
  - name: ms_drg_description
    description: The MS-DRG description associted with the inpatient visit
  - name: medical_surgical
    description: Indicates whether the MS-DRG is medical or surgical in nature.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
  - name: apr_drg_code
    description: The APR-DRG code associted with the inpatient visit
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__apr_drg.csv
  - name: apr_drg_description
    description: The APR-DRG description associted with the inpatient visit
  - name: admit_source_code
    description: Admission source code for the encounter.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
  - name: admit_source_description
    description: Admission source description for the encounter.
  - name: admit_type_code
    description: Admission type code for the encounter.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
  - name: admit_type_description
    description: Admission type description for the encounter.
  - name: discharge_disposition_code
    description: Discharge disposition code for the encounter.
    meta:
      terminology: 
        https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
  - name: discharge_disposition_description
    description: Discharge disposition description for the encounter.
  - name: total_paid_amount
    description: The total paid amount across all claims for the encounter.
  - name: total_allowed_amount
    description: The total allowed amount across all claims for the encounter.
  - name: total_charge_amount
    description: The total charge amount across all claims for the encounter.
  - name: length_of_stay
    description: The length of stay for the encounter.
  - name: mortality_flag
    description: 1 if a patient died during the encounter, 0 otherwise.
  - name: data_source
    description: User-configured field that indicates the data source (e.g. typically
      named after the payer and state "BCBS Tennessee").
  - name: tuva_last_run
    description: The time at with the model was materialized. Generated by `dbt_utils.pretty_time`
      as the local time of the `dbt run` environment.  Timezone is configurable via
      the `tuva_last_run` var.

  ### Intermediate

